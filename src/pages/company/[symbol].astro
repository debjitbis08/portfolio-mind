---
import Layout from "../../layouts/Layout.astro";
import { validateSession } from "../../lib/auth";
import CompanyDetails from "../../components/company/CompanyDetails";

// Check auth on server side
const session = await validateSession(Astro.request);

// Redirect if not logged in
if (!session) {
  return Astro.redirect("/login");
}

// Get symbol from URL
const { symbol } = Astro.params;

if (!symbol) {
  return Astro.redirect("/dashboard");
}
---

<Layout title={`${symbol} - Portfolio Mind`}>
  <CompanyDetails symbol={symbol} client:only="solid" />
</Layout>
